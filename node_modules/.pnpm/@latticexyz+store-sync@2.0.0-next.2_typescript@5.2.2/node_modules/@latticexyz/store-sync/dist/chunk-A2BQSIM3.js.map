{"version":3,"sources":["../src/trpc-indexer/createAppRouter.ts","../src/trpc-indexer/createIndexerClient.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { StorageAdapter } from \"./common\";\nimport { isHex } from \"viem\";\nimport { initTRPC } from \"@trpc/server\";\nimport superjson from \"superjson\";\n\n// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\nexport function createAppRouter() {\n  const t = initTRPC.context<{ storageAdapter: StorageAdapter }>().create({\n    transformer: superjson,\n  });\n\n  return t.router({\n    findAll: t.procedure\n      .input(\n        z.object({\n          chainId: z.number(),\n          address: z.string().refine(isHex).optional(),\n        })\n      )\n      .query(async (opts): ReturnType<StorageAdapter[\"findAll\"]> => {\n        const { storageAdapter } = opts.ctx;\n        const { chainId, address } = opts.input;\n        return storageAdapter.findAll(chainId, address);\n      }),\n  });\n}\n\nexport type AppRouter = ReturnType<typeof createAppRouter>;\n","import { createTRPCProxyClient, httpBatchLink, CreateTRPCProxyClient } from \"@trpc/client\";\nimport superjson from \"superjson\";\nimport type { AppRouter } from \"./createAppRouter\";\n\ntype CreateIndexerClientOptions = {\n  /**\n   * tRPC endpoint URL like `https://indexer.dev.linfra.xyz/trpc`.\n   */\n  url: string;\n};\n\n/**\n * Creates a tRPC client to talk to a MUD indexer.\n *\n * @param {CreateIndexerClientOptions} options See `CreateIndexerClientOptions`.\n * @returns {CreateTRPCProxyClient<AppRouter>} A typed tRPC client.\n */\nexport function createIndexerClient({ url }: CreateIndexerClientOptions): CreateTRPCProxyClient<AppRouter> {\n  return createTRPCProxyClient<AppRouter>({\n    transformer: superjson,\n    links: [httpBatchLink({ url })],\n  });\n}\n"],"mappings":"AAAA,OAAS,KAAAA,MAAS,MAElB,OAAS,SAAAC,MAAa,OACtB,OAAS,YAAAC,MAAgB,eACzB,OAAOC,MAAe,YAGf,SAASC,GAAkB,CAChC,IAAMC,EAAIH,EAAS,QAA4C,EAAE,OAAO,CACtE,YAAaC,CACf,CAAC,EAED,OAAOE,EAAE,OAAO,CACd,QAASA,EAAE,UACR,MACCL,EAAE,OAAO,CACP,QAASA,EAAE,OAAO,EAClB,QAASA,EAAE,OAAO,EAAE,OAAOC,CAAK,EAAE,SAAS,CAC7C,CAAC,CACH,EACC,MAAM,MAAOK,GAAgD,CAC5D,GAAM,CAAE,eAAAC,CAAe,EAAID,EAAK,IAC1B,CAAE,QAAAE,EAAS,QAAAC,CAAQ,EAAIH,EAAK,MAClC,OAAOC,EAAe,QAAQC,EAASC,CAAO,CAChD,CAAC,CACL,CAAC,CACH,CC1BA,OAAS,yBAAAC,EAAuB,iBAAAC,MAA4C,eAC5E,OAAOC,MAAe,YAgBf,SAASC,EAAoB,CAAE,IAAAC,CAAI,EAAiE,CACzG,OAAOJ,EAAiC,CACtC,YAAaE,EACb,MAAO,CAACD,EAAc,CAAE,IAAAG,CAAI,CAAC,CAAC,CAChC,CAAC,CACH","names":["z","isHex","initTRPC","superjson","createAppRouter","t","opts","storageAdapter","chainId","address","createTRPCProxyClient","httpBatchLink","superjson","createIndexerClient","url"]}